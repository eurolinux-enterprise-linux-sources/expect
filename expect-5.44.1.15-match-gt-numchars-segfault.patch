diff -up expect-5.44.1.15/expect.c.orig expect-5.44.1.15/expect.c
--- expect-5.44.1.15/expect.c.orig	2012-01-26 11:49:34.504668741 +0100
+++ expect-5.44.1.15/expect.c	2012-01-26 11:50:37.338175281 +0100
@@ -2360,7 +2360,12 @@ expMatchProcess(
 
 	/* "!e" means no case matched - transfer by default */
 	if (!e || e->transfer) {
-	    int remainder = numchars-match;
+	    int remainder;
+	    if (match > numchars) {
+		match = numchars;
+		eo->matchlen = match;
+	    }
+	    remainder = numchars-match;
 	    /* delete matched chars from input buffer */
 	    esPtr->printed -= match;
 	    if (numchars != 0) {
